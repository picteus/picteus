{
  "name": "@picteus/electron",
  "version": "0.6.0",
  "productName": "Picteus",
  "description": "The Picteus Electron application.",
  "keywords": [
    "picture",
    "image",
    "lens",
    "voyager",
    "explorer",
    "search",
    "Odysseus"
  ],
  "author": {
    "name": "Ã‰douard Mercier",
    "email": "edouard@koppasoft.com",
    "url": "https://github.com/edouardmercier"
  },
  "license": "GNU Affero General Public License",
  "private": false,
  "engines": {
    "node": ">=22.17.1"
  },
  "homepage": "https://github.com/picteus/Picteus.git",
  "repository": {
    "type": "git",
    "url": "https://github.com/picteus/Picteus.git"
  },
  "bugs": {
    "url": "https://github.com/picteus/Picteus/issues"
  },
  "config": {
    "package_fileName": "Picteus",
    "distribution_directoryPath": "../dist",
    "buildDirectoryPath": "build",
    "temporary_directoryPath": "../tmp",
    "productName": "Picteus",
    "bundleId": "com.koppasoft.picteus",
    "company": "KoppaSoft",
    "entitlements_filePath": "entitlements.mac.plist",
    "macos_key_chain_name": "Picteus.keychain-db",
    "macos_key_chain_password": "picteus",
    "apple_identity_company": "KoppaSoft",
    "apple_identity": "Developer ID Application: KoppaSoft",
    "apple_email": "register@koppasoft.com",
    "apple_password": "@keychain:Picteus",
    "apple_asc_provider": "282H9F7ZPF",
    "google_cloud_storage_bucket_folder": "gs://understitiel/picteus/"
  },
  "type": "module",
  "scripts": {
    ".env": "node -e \"fs.writeFileSync('.env', 'ARCHITECTURE=' + process.arch + '\\n', { encoding: 'utf8'});\"",
    "reset": "npm run clean && shx rm -rf node_modules",
    "clean": "cross-var shx rm -rf .env \"$npm_package_config_buildDirectoryPath\"",
    "updateVersion": "gulp updateVersion",
    "electron:sign.comment": "The explanation about the signature is available at https://apple.stackexchange.com/questions/3271/how-to-get-rid-of-firewall-accept-incoming-connections-dialog/150711#150711",
    "electron:sign": "sudo codesign --force --deep --sign - node_modules/electron/dist/Electron.app",
    "compile": "tsc && tsc-alias --resolve-full-paths && cross-var node -e \"const object = {}; object.type = 'module'; fs.writeFileSync(path.join('$npm_package_config_buildDirectoryPath', 'electron', 'package.json'), JSON.stringify(object), { encoding: 'utf8'});\"",
    "obfuscate": "cross-var \"javascript-obfuscator \"$npm_package_config_buildDirectoryPath/electron/src\" --output \"$npm_package_config_buildDirectoryPath/electron/src\" --compact true --options-preset high-obfuscation --rename-globals true --self-defending true -- target node && shx rm -rf \"$npm_package_config_buildDirectoryPath/electron/src/**/*.map\"\"",
    "build": "cross-var \"npm run compile && npm run obfuscate && shx cp -rf assets \"$npm_package_config_buildDirectoryPath/electron\"\"",
    "start": "cross-env SDK_DIRECTORY_PATH=\"$npm_package_config_buildDirectoryPath/sdk\" electron . run",
    "start:help": "cross-env SDK_DIRECTORY_PATH=\"$npm_package_config_buildDirectoryPath/sdk\" electron . run --help",
    "start:custom": "cross-env SDK_DIRECTORY_PATH=\"$npm_package_config_buildDirectoryPath/sdk\" electron . run --useSsl false --apiServerPort 3001 --webServerPort 2999 --requiresApiKeys true --unpackedExtensionsDirectoryPath ../extensions/instances",
    "debug:main": "cross-env SDK_DIRECTORY_PATH=\"$npm_package_config_buildDirectoryPath/sdk\" electron . run --inspect=5858 --trace-warnings",
    "debug:main:break": "cross-env SDK_DIRECTORY_PATH=\"$npm_package_config_buildDirectoryPath/sdk\" electron . run --inspect-brk=5858",
    "debug:renderer": "electron . run --remote-debugging-port=9222",
    "sign:darwin:keychain.comment": "The work-around for adding a keychain to the search list has been taken from https://stackoverflow.com/questions/10538942/add-a-keychain-to-search-list",
    "sign:darwin:keychain": "export CERTIFICATE_FILE_PATH=\"$npm_package_config_temporary_directoryPath/certificate.p12\" && echo \"$MACOS_APPLICATION_CERTIFICATE_BASE64_CONTENT\" | base64 --decode -o \"$CERTIFICATE_FILE_PATH\" && (security delete-keychain \"$npm_package_config_macos_key_chain_name\" || echo Non-existing Chain '$npm_package_config_macos_key_chain_name') && security create-keychain -p \"$npm_package_config_macos_key_chain_password\" $npm_package_config_macos_key_chain_name && security set-keychain-settings -lut 21600 $npm_package_config_macos_key_chain_name && security unlock-keychain -p \"$npm_package_config_macos_key_chain_password\" $npm_package_config_macos_key_chain_namee && security import \"$CERTIFICATE_FILE_PATH\" -P \"$MACOS_APPLICATION_CERTIFICATE_PASSWORD\" -A -t cert -f pkcs12 -k $npm_package_config_macos_key_chain_name && security set-key-partition-list -S apple-tool:,apple: -k \"$npm_package_config_macos_key_chain_password\" $npm_package_config_macos_key_chain_name && security list-keychain -d user -s $(security list-keychains -d user | sed -e s/\\\"//g) $npm_package_config_macos_key_chain_name",
    "package:darwin:dotenv.comment": "Explanations about the entitlements are provided at https://stackoverflow.com/questions/66601305/electron-app-notorizing-notorized-electron-app-cannot-be-opened-on-other-machin",
    "package:darwin:dotenv": "gulp preparePackageBuilder --architecture $ARCHITECTURE --entitlementFilePath \"$npm_package_config_entitlements_filePath\" --directoryPath \"$npm_package_config_temporary_directoryPath/electron-builder\" --appleIdentityCompany \"$npm_package_config_apple_identity_company\" && CSC_KEYCHAIN=\"$npm_package_config_macos_key_chain_name\" electron-builder build --macos --$ARCHITECTURE --publish never --config $npm_package_config_temporary_directoryPath/electron-builder/package-builder.json && shx mv \"$npm_package_config_distribution_directoryPath/latest-mac.yml\" \"$npm_package_config_distribution_directoryPath/update.yml\"",
    "prepackage:darwin": "npm run .env",
    "package:darwin": "npm run sign:darwin:keychain && dotenv -- npm run package:darwin:dotenv",
    "package:linux:dotenv": "gulp preparePackageBuilder --architecture $ARCHITECTURE --directoryPath \"$npm_package_config_temporary_directoryPath/electron-builder\" && electron-builder build --linux --$ARCHITECTURE --publish never --config \"$npm_package_config_temporary_directoryPath/electron-builder/package-builder.json\"",
    "prepackage:linux": "npm run .env",
    "package:linux": "dotenv -- npm run package:linux:dotenv",
    "package:windows:dotenv": "gulp preparePackageBuilder --architecture %ARCHITECTURE% --directoryPath \"%npm_package_config_temporary_directoryPath%/electron-builder\" && electron-builder build --windows --%ARCHITECTURE% --publish never --config %npm_package_config_temporary_directoryPath%/electron-builder/package-builder.json && shx mv \"%npm_package_config_distribution_directoryPath%/latest.yml\" \"%npm_package_config_distribution_directoryPath%/update.yml\"",
    "prepackage:windows": "npm run .env",
    "package:windows": "dotenv -- npm run package:windows:dotenv",
    "package": "run-script-os",
    "sign:darwin.comment": "The Apple certificates are managed at https://developer.apple.com/account/resources/certificates/list. You need to declare a macOS key 'Picteus' and to have installed via Xcode the 'Developer ID Application' and 'Developer ID Installer' certificates. We take care of unpacking some artifacts from the .asar archive",
    "sign:darwin:electron-osx-sign:dotenv": "cross-env DEBUG=electron-osx-sign* electron-osx-sign \"$npm_package_config_distribution_directoryPath/mac-$ARCHITECTURE/$npm_package_config_package_fileName.app\" --platform=darwin --type=distribution --identity=\"$npm_package_config_apple_identity\" --no-pre-auto-entitlements --no-identityValidation --keychain=$npm_package_config_macos_key_chain_name",
    "presign:darwin:electron-osx-sign": "npm run .env",
    "sign:darwin:electron-osx-sign": "dotenv -- npm run sign:darwin:electron-osx-sign:dotenv",
    "sign:darwin:dotenv": "npm run sign:darwin:keychain && npm run sign:darwin:electron-osx-sign",
    "presign:darwin": "npm run .env",
    "sign:darwin": "dotenv -- npm run sign:darwin:dotenv",
    "sign:linux": "",
    "sign:windows": "",
    "sign": "run-script-os",
    "zip:darwin:dotenv": "/usr/bin/ditto -c -k --keepParent \"$npm_package_config_distribution_directoryPath/mac-$ARCHITECTURE/$npm_package_config_productName.app\" \"$npm_package_config_distribution_directoryPath/$npm_package_config_package_fileName-v$npm_package_version-darwin-$ARCHITECTURE.zip\"",
    "prezip:darwin": "npm run .env",
    "zip:darwin": "dotenv -- npm run zip:darwin:dotenv",
    "zip:linux": "",
    "zip:windows": "",
    "zip": "run-script-os",
    "notarize:darwin.comment": "A dedicated 'Picteus' application-specific password has been declared. The documentation for notarizing a macOS application is avaible at https://developer.apple.com/documentation/security/notarizing_your_app_before_distribution and on KoppaSoft's wiki at https://koppasoft.atlassian.net/wiki/spaces/KOP/pages/425033741/Software+development. To declare an application-specific password, follow the instructions at https://discussions.apple.com/thread/254805086?sortBy=rank",
    "notarize:darwin:dotenv": "xcrun notarytool submit --apple-id \"$npm_package_config_apple_email\" --team-id \"$npm_package_config_apple_asc_provider\" --password \"$MACOS_NOTARIZE_APPLICATION_PASSWORD\" \"$npm_package_config_distribution_directoryPath/$npm_package_config_package_fileName-v$npm_package_version-darwin-$ARCHITECTURE.zip\"",
    "prenotarize:darwin": "npm run .env",
    "notarize:darwin": "dotenv -- npm run notarize:darwin:dotenv",
    "staple:darwin.comment": "The documentation for stapling a macOS application is available at https://developer.apple.com/documentation/security/notarizing_your_app_before_distribution/customizing_the_notarization_workflow#3087734",
    "staple:darwin:dotenv": "xcrun stapler staple \"$npm_package_config_distribution_directoryPath/mac-$ARCHITECTURE/$npm_package_config_productName.app\"",
    "prestaple:darwin": "npm run .env",
    "staple:darwin": "dotenv -- npm run staple:darwin:dotenv",
    "distribute:darwin": "npm-run-all package zip notarize:darwin",
    "distribute:linux": "npm-run-all package zip",
    "distribute:windows": "npm-run-all package zip",
    "distribute": "run-script-os",
    "updateFeed:generate": "cross-var gulp generateUpdateFeed --inputFilePath \"$npm_package_config_distribution_directoryPath/update.yml\" --directoryPath \"$npm_package_config_temporary_directoryPath/electron-builder\" --bucket $npm_package_config_google_cloud_storage_bucket_folder",
    "deploy:darwin:dotenv": "gcloud storage cp --no-clobber --canned-acl publicRead \"$npm_package_config_distribution_directoryPath/$npm_package_config_package_fileName-v$npm_package_version-darwin-$ARCHITECTURE.zip\" $npm_package_config_google_cloud_storage_bucket_folder",
    "predeploy:darwin": "npm run .env",
    "deploy:darwin": "dotenv -- npm run deploy:darwin:dotenv",
    "deploy:linux:dotenv": "",
    "predeploy:linux": "npm run .env",
    "deploy:linux": "dotenv -- npm run deploy:linux:dotenv",
    "deploy:windows:dotenv": "gcloud storage cp --no-clobber --canned-acl publicRead \"%npm_package_config_distribution_directoryPath%/%npm_package_config_package_fileName%-v%npm_package_version%-win32-%ARCHITECTURE%.exe\" %npm_package_config_google_cloud_storage_bucket_folder%",
    "predeploy:windows": "npm run .env",
    "deploy:windows": "dotenv -- npm run deploy:windows:dotenv",
    "updateFeed:deploy": "cross-var gulp deployUpdateFeed --directoryPath \"$npm_package_config_temporary_directoryPath/electron-builder\" --bucket $npm_package_config_google_cloud_storage_bucket_folder",
    "deploy": "run-script-os && npm-run-all updateFeed:generate updateFeed:deploy"
  },
  "main": "./build/electron/src/main.js",
  "devDependencies": {
    "npm-run-all": "4.1.5",
    "shx": "0.4.0",
    "dotenv-cli": "10.0.0",
    "cross-env": "10.0.0",
    "cross-var": "1.1.0",
    "run-script-os": "1.1.6",
    "replace-in-files-cli": "4.0.0",
    "javascript-obfuscator": "5.2.1",
    "gulp": "4.0.2",
    "gulp-run": "1.7.1",
    "electron": "40.1.0",
    "electron-builder": "26.4.0",
    "fs-extra": "11.3.3",
    "glob": "13.0.0",
    "typescript": "5.9.2",
    "tsc-alias": "1.8.16",
    "@types/node": "22.17.1",
    "@types/semver": "7.7.1",
    "@types/tar-fs": "2.0.4",
    "yaml": "2.8.2"
  },
  "dependencies": {
    "winston": "3.17.0",
    "socket.io": "4.8.1",
    "electron-updater": "6.6.8",
    "semver": "7.7.3",
    "tar-fs": "3.1.1",
    "@picteus/shared-back-end": "file:../shared/back-end"
  }
}
